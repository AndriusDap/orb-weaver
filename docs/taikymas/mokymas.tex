\ktusection{Modelio mokymas}

Modelio apmokymas vykdomas programinės įrangos paketu Vowpal Wabbit \cite{vw}.

\ktusubsection{Atraminių vektorių klasifikatoriaus mokymas}

Naudojant atraminių vektorių klasifikatorių sistemoje Vowpal Wabbit naudojami parametrai nurodyti \vref{tab:ksvm_params} lentelėje.

\begin{ktutable}{ksvm_params}{Atraminių vektorių klasifikatoriaus hiperparametrai}
    \begin{tabular}{| l | l | p{7cm}|}
    \hline
        Komandinės eilutės parametras & Galimos vertės & Parametro reikšmė\\ \hline
        \texttt{passes} &  & Modelio mokymo iteracijų skaičius \\ \hline
        \texttt{loss\_function} &          & Mokymo metu naudojama nuostolio funkcija \\
                               & squared  & Modelio mokymo iteracijų skaičius \\
                               & hinge    & nuostolio funkcija $l(y) = \max(0, 1 - t * y)$ kur $y$ yra įvertis o $t = \pm 1$ tikroji klasė  \\
                               & logistic & logistinė nuostolio funkcija \\ \hline
        \texttt{l2} & & l2 parametrų reguliarizacija \\ \hline
        \texttt{bit\_precision} & & Bitų, naudojamų savybių lentelei, skaičius\\ \hline
        \texttt{kernel} & & Naudojama branduolio funkcija   \\
                       & poly & polinominis branduolis     \\
                       & linear & tiesinis branduolis      \\
                       & rbf & radialinės bazės branduolis \\ \hline
        \texttt{degree} & & polinominio branduolio laipsnis \\ \hline
    \end{tabular}
\end{ktutable}

Mokant atraminių vektorių klasifikatorių stebimas nuostolių funkcijos įvertis. Pagal jį
vertinamas modelio mokymo sėkmingumas.

Modeliai pradėti mokyti nuo polinominio branduolio. Svarbūs parametrai derinant šį modelį yra polinominės
funkcijos laipsnis bei parametrų reguliarizavimo koeficientas.

\begin{ktutable}{initial_train}{Pirminio polinominio branduolio modelio parametrai}
    \begin{tabular}{| l | c | c | c | c | c | c | }
    \hline
        Kernelio funkcija & polinominė & polinominė & polinominė & polinominė & polinominė & polinominė \\ \hline
        L2 reguliarizacija & $10^{-7}$ & $10^{-5}$ & 0.1 & $10^{-7}$ & $10^{-5}$ & 0.1 \\ \hline
        Kernelio funkcijos laipsnis & 5 & 5 & 5 & 3 & 3 & 3 \\ \hline
    \end{tabular}
\end{ktutable}

Mokant modelį naudojant parametrus nurodytus lentelėje \vref{tab:initial_train} pastebėta tendencija.
Modelio kokybė mokymo metu negerėja. Tai atspindi šių parametrų nuostolio funkcijų grafikai
\ktufigref{images/svm_sux.png}. Naudojant parametrų rinkinius iš lentelės \vref{tab:initial_train}
modelis nekonverguoja.

\ktufigure{images/svm_sux.png}{14 cm}{Modelio kokybės tendencijos}

Modelio mokymas toliau tyrinėtas naudojant kitas branduolio funkcijas ir derinant jų parametrus.
Modelio parametrų reguliarizacijos parametras L2 nekeistas.

\ktufigure{images/linear_loss.png}{12 cm}{Tiesinio branduolio modelio mokymas}
\ktufigure{images/polly_loss.png}{12 cm}{Polinominio branduolio modelio mokymas}
\ktufigure{images/rbf_loss.png}{12 cm}{Radialinės bazės funkcijos branduolio modelio mokymas}

Naudojant kitus branduolio tipus pastebėta ta pati tendencija, matoma \ktufigref{images/linear_loss.png}, \ktufigref{images/polly_loss.png}, \ktufigref{images/rbf_loss.png} grafikuose.

\ktusubsection{Tiesinio modelio mokymas}

Vowpal Wabbit sistema visiems modeliams naudoja vienodą duomenų formatą bei panašius parametrus.
Tai leidžia lengvai bandyti įvairius modelius. Dėl to po prastų atraminių vektorių klasifikatoriaus rezultatų
pasirinktas vienas iš paprasčiausių modelių, kuriuo tikėtina pasiekti gerus rezultatus, nenaudojant
didelio resursų kiekio modelio formavimui.

\begin{ktutable}{linear_params}{Tiesinio modelio hiperparametrai}
    \begin{tabular}{| l | l | p{7cm}|}
    \hline
        Komandinės eilutės parametras & Galimos vertės & Parametro reikšmė\\ \hline
        \texttt{passes} &  & Modelio mokymo iteracijų skaičius \\ \hline
        \texttt{loss\_function} &          & Mokymo metu naudojama nuostolio funkcija \\
                               & squared  & Modelio mokymo iteracijų skaičius \\
                               & hinge    & nuostolio funkcija $l(y) = \max(0, 1 - t * y)$ kur $y$ yra įvertis o $t = \pm 1$ tikroji klasė  \\
                               & logistic & logistinė nuostolio funkcija \\ \hline
        \texttt{l2} & & l2 parametrų reguliarizacija \\ \hline
        \texttt{bit\_precision} & & Bitų, naudojamų savybių lentelei, skaičius\\ \hline
    \end{tabular}
\end{ktutable}

Mokant tiesinį modelį naudojamas mažesnis savybių lentelės dydis nurodomas naudojant \texttt{bit\_precision}
 parametrą. Tai leidžia optimaliau atlikti mokymą sumažinant naudojamą atminties kiekį. Naudojami $27$ bitai.

Pirminiai modelio mokymo rezultatai pateikiami \ktufigref{images/linearModelLoss.png}. Šiame grafike
matoma, kad nuostolio funkcijos rezultatai yra žymiai geresni nei mokant atraminių vektorių klasifikatorius. Mokomas modelis konverguoja, pasiekiama gana pastovi nuostolio funkcijos reikšmė, kuri
yra nedidelė, artima nuliui.

\ktufigure{images/linearModelLoss.png}{14 cm}{Tiesinio modelio mokymas}

Apmokius modelį vertinamas jo jautrumas, tikslumas, specifiškumas, AUC įvertis. Jie pateikiami
lentelėje \vref{tab:firstLinearModel}. Parametrų L2 reguliarizavimui naudota vertė $10^{-6}$.

Gautas modelis itin gerai prognozuoja testavimo rinkinio duomenis. Suformuotas tiesinis modelis naudoja
$145832$ matmenų.

\begin{ktutable}{firstLinearModel}{Pirminio tiesinio modelio rezultatai}
    \begin{tabular}{| l | l |}
    \hline
       Matas & Reikšmė \\ \hline
               Tikslumas & 0.97552 \\ \hline
               Jautrumas & 0.92588 \\ \hline
               Specifiškumas & 0.98325 \\ \hline
               AUC & 0.95456 \\ \hline
    \end{tabular}
\end{ktutable}

\ktufigure{images/roc.png}{12 cm}{Tiesinio modelio ROC kreivė}

Lyginant šio modelio rezultatus pateiktus \cite{comp} straipsnyje šis tiesinis modelis pralenkia
atraminių vektorių klasifikatorių, kuris šiame straipsnyje buvo išskiriamas kaip geriausias klasifikatorius.

\ktusubsection{Sprendimų medžio modelio formavimas}

\ktufigure{images/treeLoss.png}{12 cm}{Sprendimų medžio modelio nuostolio funkcija}

Paskutinis naudojamas modelis yra sprendimų medis. Modelio naudojami parametrai pateikiami lentelėje \vref{tab:medisParams}.

\begin{ktutable}{medisParams}{Sprendimų medžio modelio hiperparametrai}
    \begin{tabular}{| l | l | p{7cm}|}
    \hline
        Komandinės eilutės parametras & Galimos vertės & Parametro reikšmė\\ \hline
        \texttt{passes} &  & Modelio mokymo iteracijų skaičius \\ \hline
        \texttt{loss\_function} &          & Mokymo metu naudojama nuostolio funkcija \\
                               & squared  & Modelio mokymo iteracijų skaičius \\
                               & hinge    & nuostolio funkcija $l(y) = \max(0, 1 - t * y)$ kur $y$ yra įvertis o $t = \pm 1$ tikroji klasė  \\
                               & logistic & logistinė nuostolio funkcija \\ \hline
        \texttt{l2} & & l2 parametrų reguliarizacija \\ \hline
        \texttt{bit\_precision} & & Bitų, naudojamų savybių lentelei, skaičius\\ \hline
        \texttt{log\_multi} & & Siekiamas sprendimų medžio kompleksiškumas laiko atžvilgiu, $O(log(n))$ kur $n$ yra šio parametro vertė\\ \hline
    \end{tabular}
\end{ktutable}

Sprendimų medžio modelio mokymas vyksta sėkmingai, stebint nuostolio funkcijos vertes \ktufigref{images/treeLoss.png}.

Nepaisant gero nuostolio funkcijos rezultato šis modelis persimokė su visomis naudotomis
hiperparametrų vertėmis. Šis modelis visada prognozuoja tik vieną iš reikšmių, tai yra
klasifikacija nevykdoma, modelis visada grąžina kad analizuojamas vektorius priklauso klasei 1 (svetainė nežalinga).

\ktusubsection{Modelių mokymo rezultatai}

Kokybiško atraminių vektorių klasifikatoriaus bei sprendimų medžio apmokyti nepavyko.
Tikėtina, kad tai lemia naudojamo duomenų tipo specifika. Duomenys turi itin daug
matmenų - kiekvienas naujas žodis, simbolių grupė yra koduojama kaip naujas matmuo.
Tačiau suformuotas itin tikslus tiesinis modelis. Lyginant tiesinio modelio rezultatus
su pateiktais įvairių modelių rezultatais straipsnyje \cite{comp}, kurie pateikiami
lentelėje \vref{tab:compTable} visą mokymą galima laikyti pasisekusiu. Nors apmokytas
tik vienas modelis iš trijų jis yra itin tikslus ir lenkia atraminių vektorių mašinų klasifikatorių, kuris buvo įvertintas kaip geriausias.

\begin{ktutable}{compTable}{Pirminio tiesinio modelio rezultatai}
    \begin{tabular}{|l|p{3cm}|p{3cm}|p{3cm}|p{3cm}|}
    \hline
                             & Tiesinis modelis  &  K Artimiausių kaimynų modelis  &  Radialinės bazės funkcijos branduolio atraminių vektorių klasifikatorius  &  Tiesinio branduolio atraminių vektorių klasifikatorius \\ \hline
               Tikslumas     & 0.97552           & 0.91   & 0.97  &  0.92         \\ \hline
    \end{tabular}
\end{ktutable}

Šis modelis toliau naudojamas klasifikavimo įrankio kūrime.
