\ktusection{Modelio mokymas}

Modelio apmokymas vykdomas programinės įrangos paketu Vowpal Wabbit \cite{vw}.

\ktusubsection{Atramos vektorių mašinų modelio mokymas}

Naudojant atramos vektorių mašinų modelį sistema Vowpal Wabbit naudojami parametrai nurodyti \vref{tab:ksvm_params} lentelėje.

\begin{ktutable}{ksvm_params}{Atramos vektorių mašinų modelio hiperparametrai}
    \begin{tabular}{| l | l | p{7cm}|}
    \hline
        Komandinės eilutės parametras & Galimos vertės & Parametro reikšmė\\ \hline
        \texttt{passes} &  & Modelio mokymo iteracijų skaičius \\ \hline
        \texttt{loss\_function} &          & Mokymo metu naudojama nuostolio funkcija \\
                               & squared  & Modelio mokymo iteracijų skaičius \\
                               & hinge    & nuostolio funkcija $l(y) = \max(0, 1 - t * y)$ kur $y$ yra įvertis o $t = \pm 1$ tikroji klasė  \\
                               & logistic & logistinė nuostolio funkcija \\ \hline
        \texttt{l2} & & l2 parametrų reguliarizacija \\ \hline
        \texttt{bit\_precision} & & Bitų, naudojamų savybių lentelei, skaičius\\ \hline
        \texttt{kernel} & & Naudojama kernelio funkcija   \\
                       & poly & polinominis kernelis     \\
                       & linear & tiesinis kernelis      \\
                       & rbf & radialinės bazės kernelis \\ \hline
        \texttt{degree} & & polinominio kernelio laipsnis \\ \hline
    \end{tabular}
\end{ktutable}

Mokant atraminių vektorių mašinų modelį stebimas nuostolių funkcijos įvertis. Pagal jį vertinamas modelio mokymo sėkmingumas.

Modeliai pradėti mokyti nuo polinominio kernelio. Svarbūs parametrai derinant šį modelį yra polinominės funkcijos laipsnis bei parametrų reguliarizavimo koeficientas.

\begin{ktutable}{initial_train}{Pirminio polinominio kernelio modelio parametrai}
    \begin{tabular}{| l | c | c | c | c | c | c | }
    \hline
        Kernelio funkcija & polinominė & polinominė & polinominė & polinominė & polinominė & polinominė \\ \hline
        L2 reguliarizacija & $10^{-7}$ & $10^{-5}$ & 0.1 & $10^{-7}$ & $10^{-5}$ & 0.1 \\ \hline
        Kernelio funkcijos laipsnis & 5 & 5 & 5 & 3 & 3 & 3 \\ \hline
    \end{tabular}
\end{ktutable}

Mokant modelį naudojant parametrus nurodytus lentelėje \vref{tab:initial_train} pastebėta tendencija. Modelio kokybė mokymo metu negerėja. Tai atspindi šių parametrų nuostolio funkcijų grafikai \ktufigref{images/svm_sux.png}. Naudojant parametrų rinkinius iš lentelės \vref{tab:initial_train} modelis nekonverguoja.

\ktufigure{images/svm_sux.png}{14 cm}{Modelio kokybės tendencijos}

Modelio mokymas toliau tyrinėtas naudojant kitas branduolio funkcijas ir derinant jų parametrus. Modelio parametrų reguliarizacijos parametras L2 nekeistas.

\ktufigure{images/linear_loss.png}{12 cm}{Tiesinio kernelio modelio mokymas}
\ktufigure{images/polly_loss.png}{12 cm}{Polinominio kernelio modelio mokymas}
\ktufigure{images/rbf_loss.png}{12 cm}{Radialinės bazės funkcijos kernelio modelio mokymas}

Naudojant kitus kernelio tipus pastebėta ta pati tendencija, matoma \ktufigref{images/linear_loss.png}, \ktufigref{images/polly_loss.png}, \ktufigref{images/rbf_loss.png} grafikuose.

\ktusubsection{Tiesinio modelio mokymas}

Vowpal Wabbit sistema visiems modeliams naudoja vienodą duomenų formatą bei paanšius parametrus. Tai leidžia lengvai bandyti įvairius modelius. Dėl to po prasto atraminių vektorių mašinų modelių pasirinktas vienas iš paprasčiausių modelių, kuriuo tiėktina pasiekti gerus rezultatus, nenaudojant didelio resursų kiekio modelio formavimui.

\begin{ktutable}{linear_params}{Tiesinio modelio hiperparametrai}
    \begin{tabular}{| l | l | p{7cm}|}
    \hline
        Komandinės eilutės parametras & Galimos vertės & Parametro reikšmė\\ \hline
        \texttt{passes} &  & Modelio mokymo iteracijų skaičius \\ \hline
        \texttt{loss\_function} &          & Mokymo metu naudojama nuostolio funkcija \\
                               & squared  & Modelio mokymo iteracijų skaičius \\
                               & hinge    & nuostolio funkcija $l(y) = \max(0, 1 - t * y)$ kur $y$ yra įvertis o $t = \pm 1$ tikroji klasė  \\
                               & logistic & logistinė nuostolio funkcija \\ \hline
        \texttt{l2} & & l2 parametrų reguliarizacija \\ \hline
        \texttt{bit\_precision} & & Bitų, naudojamų savybių lentelei, skaičius\\ \hline
    \end{tabular}
\end{ktutable}

Mokant tiesinį modelį naudojamas mažesnis sąvybių lentelės dydis nurodomas naudojant \texttt{bit\_precision} parametrą. Tai leidžia optimialiau atlikti mokymą sumažinant naudojamą atminties kiekį. Naudojami $27$ bitai.

Pirminiai modelio mokymo rezultatai pateikiami \ktufigref{images/linearModelLoss.png}. Šiame grafike matoma, kad nuostolio funkcijos rezultatai yra žymiai geresni nei mokant atraminių veotkrių mašinų modelius. Mokomas modelis konverguoja, pasiekiama gana pastovi nuostolio funkcijos reikšmė, kuri yra nedidelė, artima nuliui.

\ktufigure{images/linearModelLoss.png}{14 cm}{Tiesinio modelio mokymas}

Apmokius modelį vertinamas jo jautrumas, tikslumas, specifiškumas, AUC įvertis. Jie pateikiami lentelėje \vref{tab:firstLinearModel}. Parametrų L2 reguliarizavimui naudota vertė $10^{-6}$.
Gautas modelis itin gerai prognozuoja testavimo rinkinio duomenis. Suformuotas tiesinis modelis naudoja
$145832$ matmenų.

\begin{ktutable}{firstLinearModel}{Pirminio tiesinio modelio rezultatai}
    \begin{tabular}{| l | l |}
    \hline
       Matas & Reikšmė \\ \hline
               Tikslumas & 0.97552 \\ \hline
               Jautrumas & 0.92588 \\ \hline
               Specifiškumas & 0.98325 \\ \hline
               AUC & 0.95456 \\ \hline
    \end{tabular}
\end{ktutable}

\ktufigure{images/roc.png}{12 cm}{Tiesinio modelio ROC kreivė}

Lyginant šio modelio rezultatus pateiktus \cite{comp} straipsnyje šis tiesinis modelis pralenkia atraminių vektorių mašinų klasifikatorių, kuris šiame strapsnyje buvo išskiriamas kaip geriausias klasifikatorius.

Kokybiško atraminių vektorių mašinų modelio apmokyti nepavyko. Tikėtina, kad tai lemia naudojamo duomenų tipo specifika. Duomenys turi itin daug matmenų - kiekvienas naujas žodis, simbolių grupė yra koduojama kaip naujas matmuo. Tai